import openpyxl

data = [
    {"id": 1, "lastName": "Snow", "firstName": "Jon"},
    {"id": 2, "lastName": "Lannister", "firstName": "Cersei"},
    {"id": 3, "lastName": "Lannister", "firstName": "Jaime"},
    {"id": 4, "lastName": "Stark", "firstName": "Arya"},
    {"id": 5, "lastName": "Targaryen", "firstName": "Daenerys"},
]

# Create a new Excel workbook
wb = openpyxl.Workbook()

# Select the active worksheet
ws = wb.active

# Define headers
headers = ["id", "lastName", "firstName"]

# Write headers to the first row
for col, header in enumerate(headers, start=1):
    ws.cell(row=1, column=col, value=header)

# Write data to the worksheet
for row, character in enumerate(data, start=2):
    for col, key in enumerate(headers, start=1):
        ws.cell(row=row, column=col, value=character[key])

# Save the workbook
file_name = "characters.xlsx"
wb.save(file_name)

print("Excel file created successfully:", file_name)
