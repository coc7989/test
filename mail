pipeline {
    agent any
    environment {
        MASTER_NAME = "master.com" // Replace with dynamic logic for the master server
    }
    stages {
        stage('Run Remote Commands') {
            steps {
                script {
                    echo "Connecting to ${MASTER_NAME} and running remote commands"
                    
                    // Run commands on the remote server
                    def remoteOutput = sh(script: """
                        ssh -o LogLevel=ERROR -o BatchMode=yes -o StrictHostKeyChecking=no ${MASTER_NAME} '
                            hostname; 
                            pwd; 
                            badmin reconfig 2>/dev/null
                        ' | tail -n 1
                    """, returnStdout: true).trim()
                    
                    // Log the captured output
                    echo "Output of badmin reconfig: ${remoteOutput}"
                }
            }
        }
    }
}
