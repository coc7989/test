import hudson.model.Computer

node {
    // Define the list of specific nodes to monitor
    def nodesToMonitor = ['node1', 'node2', 'node3']  // Replace with your node names
    def offlineNodes = []
    
    // Check each node in the monitor list
    for (nodeName in nodesToMonitor) {
        def node = Jenkins.instance.getNode(nodeName)?.toComputer()
        if (node == null) {
            echo "Node ${nodeName} does not exist in Jenkins."
        } else if (node.offline) {
            offlineNodes.add(node.name)
        }
    }
    
    // Send an email if any monitored nodes are offline
    if (!offlineNodes.isEmpty()) {
        def offlineNodeList = offlineNodes.join(', ')
        
        // Print to console for debugging
        echo "Offline monitored nodes: ${offlineNodeList}"
        
        // Send email notification
        emailext (
            subject: "Jenkins Alert: Offline Monitored Nodes Detected",
            body: """Hello Admin,
            
The following monitored Jenkins nodes are currently offline:
${offlineNodeList}

Please check the status of these nodes to ensure they are operational.

Best regards,
Jenkins Monitoring System
""",
            to: "admin@gmajl.com"
        )
    } else {
        echo "All monitored nodes are online."
    }
}
