// MainComponent.js
import React from 'react';
import DataGridComponent from './DataGridComponent';
import SubmitButton from './SubmitButton';
import axios from 'axios';

const MainComponent = ({ rows, columns }) => {
  const handleExportAndSend = () => {
    // Trigger export of MUI DataGrid
    const gridApi = window.grid.api;
    gridApi.exportDataAsCsv();

    // Get the CSV content from MUI DataGrid
    const csvData = gridApi.getDataAsCsv();

    // Send CSV data to backend Flask
    axios.post('/send_email', { csvData })
      .then(response => {
        console.log(response.data);
      })
      .catch(error => {
        console.error('Error sending CSV to backend:', error);
      });
  };

  return (
    <div>
      <DataGridComponent rows={rows} columns={columns} />
      <SubmitButton onClick={handleExportAndSend} />
    </div>
  );
};

export default MainComponent;
