from flask import Flask, request, jsonify
import smtplib
from email.mime.text import MIMEText

app = Flask(__name__)

@app.route('/send-mail', methods=['POST'])
def send_mail():
    data = request.json
    to = data['to']
    subject = data['subject']
    body = data['body']
    rowData = data['rowData']

    # Attach rowData to the body (you might want to format it as needed)
    body += '\n\n' + str(rowData)

    msg = MIMEText(body)
    msg['From'] = 'your_email@example.com'
    msg['To'] = to
    msg['Subject'] = subject

    # Replace 'smtp_server', 'port', 'your_email', and 'your_password' with your SMTP server details
    try:
        with smtplib.SMTP('smtp_server', port) as server:
            server.starttls()
            server.login('your_email', 'your_password')
            server.sendmail('your_email', to, msg.as_string())

        return jsonify({'message': 'Mail sent successfully'})
    except Exception as e:
        return jsonify({'error': str(e)}), 500

if __name__ == '__main__':
    app.run(debug=True)
