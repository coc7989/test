pipeline {
    agent any

    environment {
        EMAIL_TO = "p-negi@ti.com"
        DEV_IMAGE_NAME = "lsfued-backend-dev"
        PROD_IMAGE_NAME = "lsfued-backend-prod"
        DEV_AGENT = "LSFUED-DEPLOYMENT"
        PROD_AGENT = "any"
    }

    stages {
        stage('Checkout') {
            steps {
                // Checkout the repository from Bitbucket
                checkout([$class: 'GitSCM', branches: [[name: '*/${env.BRANCH_NAME}']],
                    userRemoteConfigs: [[url: 'https://bitbucket.org/your-repo/your-project.git']]
                ])
                script {
                    // Get the branch name from git
                    env.BRANCH_NAME = sh(script: 'git rev-parse --abbrev-ref HEAD', returnStdout: true).trim()
                }
            }
        }
        
        stage('Printing Env Variables') {
            steps {
                script {
                    echo "BRANCH_NAME: ${env.BRANCH_NAME}"
                }
            }
        }
    }
}
